<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="description" content="Fill Your Screen with Solid Colors.">
  <meta name="robots" content="index,follow,max-image-preview:large">
  <meta name="theme-color" content="#000000" id="themeColorMeta">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="application-name" content="Fill">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="Fill">
  <meta property="og:title" content="Fill">
  <meta property="og:description" content="Fill Your Screen with Solid Colors.">
  <meta property="og:url" content="/">
  <meta property="og:image" content="/assets/images/social-preview.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="Fill preview image">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Fill">
  <meta name="twitter:description" content="Fill Your Screen with Solid Colors.">
  <meta name="twitter:image" content="/assets/images/social-preview.png">
  <meta name="twitter:image:alt" content="Fill preview image">
  <link rel="canonical" href="/">
  <link rel="manifest" href="/assets/manifest/site.webmanifest">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-touch-icon.png">
  <link rel="icon" href="/assets/icons/favicon.svg" type="image/svg+xml">
  <title>Fill</title>
  <style>
    :root {
      color-scheme: dark;
      --ui-ink: #EAEAEA;
      --ui-muted: #8A8F98;
      --ui-hairline: rgba(255, 255, 255, 0.08);
      --ui-glass-a: rgba(23, 23, 23, 0.7);
      --ui-glass-b: rgba(23, 23, 23, 0.7);
      --ui-shadow: rgba(0, 0, 0, 0.5);
      --ui-ring: #0066FF;
      --form-bg: rgba(28, 28, 30, 0.85);
      --form-border: rgba(255, 255, 255, 0.08);
      --input-bg: rgba(0, 0, 0, 0.25);
      --input-border: rgba(255, 255, 255, 0.1);
      --input-text: #EAEAEA;
      --input-placeholder: #8A8F98;
      --custom-preview: rgba(0, 0, 0, 0.2);
      --assist-fg: #EAEAEA;
      --assist-muted: #8A8F98;
      --assist-bg: rgba(28, 28, 30, 0.85);
      --assist-bg-strong: rgba(38, 38, 40, 0.95);
      --assist-border: rgba(255, 255, 255, 0.08);
      --assist-card-bg: rgba(23, 23, 23, 0.85);
      --assist-card-border: rgba(255, 255, 255, 0.1);
      --assist-ghost-border: rgba(255, 255, 255, 0.1);
      --assist-key-bg: rgba(255, 255, 255, 0.08);
      --assist-key-border: rgba(255, 255, 255, 0.04);
      --assist-shadow: rgba(0, 0, 0, 0.5);
      --dock-radius: 14px;
      --swatch-radius: 8px;
    }

    body.ui-light {
      --ui-ink: #111827;
      --ui-muted: #6B7280;
      --ui-hairline: rgba(0, 0, 0, 0.1);
      --ui-glass-a: rgba(255, 255, 255, 0.85);
      --ui-glass-b: rgba(255, 255, 255, 0.85);
      --ui-shadow: rgba(0, 0, 0, 0.15);
      --ui-ring: #0066FF;
      --form-bg: rgba(255, 255, 255, 0.95);
      --form-border: rgba(0, 0, 0, 0.1);
      --input-bg: rgba(0, 0, 0, 0.03);
      --input-border: rgba(0, 0, 0, 0.1);
      --input-text: #111827;
      --input-placeholder: #9CA3AF;
      --custom-preview: rgba(0, 0, 0, 0.03);
      --assist-fg: #111827;
      --assist-muted: #6B7280;
      --assist-bg: rgba(255, 255, 255, 0.9);
      --assist-bg-strong: rgba(255, 255, 255, 1);
      --assist-border: rgba(0, 0, 0, 0.1);
      --assist-card-bg: rgba(255, 255, 255, 0.95);
      --assist-card-border: rgba(0, 0, 0, 0.1);
      --assist-ghost-border: rgba(0, 0, 0, 0.15);
      --assist-key-bg: rgba(0, 0, 0, 0.05);
      --assist-key-border: rgba(0, 0, 0, 0.05);
      --assist-shadow: rgba(0, 0, 0, 0.15);
    }

    html, body {
      width: 100%;
      height: 100%;
      margin: 0;
      overflow: hidden;
    }

    body {
      min-height: 100vh;
      min-height: 100dvh;
      background: black;
      transition: background-color 170ms linear;
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      user-select: none;
      -webkit-user-select: none;
      touch-action: manipulation;
    }

    #controls {
      position: fixed;
      inset: 0;
      display: grid;
      place-items: end center;
      padding: clamp(14px, 4vh, 38px);
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
      transition: opacity 720ms cubic-bezier(0.22, 1, 0.36, 1), visibility 0s linear 720ms;
      z-index: 10;
    }

    #controls.visible {
      opacity: 1;
      visibility: visible;
      pointer-events: auto;
      transition: opacity 460ms cubic-bezier(0.22, 1, 0.36, 1), visibility 0s linear 0s;
    }

    .dock-wrap {
      display: grid;
      justify-items: center;
      gap: 12px;
      transform: translateY(20px) scale(0.97);
      filter: blur(10px);
      transition: transform 560ms cubic-bezier(0.22, 1, 0.36, 1), filter 560ms cubic-bezier(0.22, 1, 0.36, 1);
    }

    #controls.visible .dock-wrap {
      transform: translateY(0) scale(1);
      filter: blur(0);
    }

    .dock {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px;
      border-radius: var(--dock-radius);
      background: var(--ui-glass-a);
      border: 1px solid var(--ui-hairline);
      box-shadow: 0 16px 32px var(--ui-shadow);
      backdrop-filter: blur(32px) saturate(180%);
      -webkit-backdrop-filter: blur(32px) saturate(180%);
    }

    .swatch {
      position: relative;
      width: 44px;
      height: 44px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: var(--swatch-radius);
      padding: 0;
      cursor: pointer;
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
      transition: transform 150ms ease, box-shadow 150ms ease, border-color 150ms ease;
      background-clip: padding-box;
    }

    body.ui-light .swatch {
      border: 1px solid rgba(0, 0, 0, 0.1);
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.5);
    }

    .swatch.is-active {
      border-color: var(--ui-ring);
      box-shadow: 0 0 0 1px var(--ui-ring);
    }

    .swatch-black { background-color: #000000; }
    .swatch-white { background-color: #ffffff; }
    .swatch-red { background-color: #FF3B30; }

    .swatch-custom {
      background: rgba(255, 255, 255, 0.05);
      color: var(--ui-ink);
      font-size: 20px;
      line-height: 1;
      font-weight: 400;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    body.ui-light .swatch-custom {
      background: rgba(0, 0, 0, 0.05);
    }

    .swatch-custom span {
      display: inline-block;
      transform: translateY(-1px);
    }

    .swatch:focus-visible,
    .custom-form input:focus-visible,
    .apply-btn:focus-visible,
    .help-ghost:focus-visible,
    .shortcut-action:focus-visible {
      outline: 2px solid var(--ui-ring);
      outline-offset: 2px;
    }

    .custom-form {
      width: min(92vw, 420px);
      display: grid;
      grid-template-columns: auto 1fr auto;
      align-items: center;
      gap: 12px;
      padding: 10px;
      border-radius: var(--dock-radius);
      background: var(--form-bg);
      border: 1px solid var(--form-border);
      box-shadow: 0 16px 32px var(--ui-shadow);
      backdrop-filter: blur(32px) saturate(180%);
      -webkit-backdrop-filter: blur(32px) saturate(180%);
      opacity: 0;
      transform: translateY(-10px) scale(0.98);
      pointer-events: none;
      visibility: hidden;
      transition: opacity 320ms ease, transform 320ms cubic-bezier(0.22, 1, 0.36, 1), visibility 0s linear 320ms;
    }

    .custom-form.open {
      opacity: 1;
      transform: translateY(0) scale(1);
      pointer-events: auto;
      visibility: visible;
      transition: opacity 320ms ease, transform 320ms cubic-bezier(0.22, 1, 0.36, 1), visibility 0s linear 0s;
    }

    .color-dot {
      width: 16px;
      height: 16px;
      margin-left: 4px;
      border-radius: 50%;
      border: 1px solid var(--ui-hairline);
      background: black;
    }

    .custom-form input,
    .apply-btn {
      border: 0;
      border-radius: 6px;
      box-sizing: border-box;
      outline: none;
    }

    .custom-form input {
      min-width: 0;
      padding: 8px 12px;
      font-size: 14px;
      font-weight: 500;
      background: var(--input-bg);
      border: 1px solid var(--input-border);
      color: var(--input-text);
      transition: border-color 150ms ease;
    }
    
    .custom-form input:focus {
      border-color: rgba(255, 255, 255, 0.3);
    }
    
    body.ui-light .custom-form input:focus {
      border-color: rgba(0, 0, 0, 0.3);
    }

    .custom-form input::placeholder {
      color: var(--input-placeholder);
      font-weight: 400;
    }

    .apply-btn {
      width: 34px;
      height: 34px;
      display: grid;
      place-items: center;
      cursor: pointer;
      color: #fff;
      font-size: 14px;
      font-weight: 500;
      background: var(--ui-ring);
      transition: filter 150ms ease;
      border-radius: 6px;
    }

    #error {
      min-height: 16px;
      font-size: 13px;
      font-weight: 500;
      line-height: 1.2;
      color: #FF453A;
      letter-spacing: 0.01em;
      text-align: center;
      opacity: 0;
      transition: opacity 160ms ease;
    }

    #error.visible {
      opacity: 1;
    }

    .help-ghost {
      position: fixed;
      right: 24px;
      bottom: 24px;
      z-index: 22;
      width: 36px;
      height: 36px;
      padding: 0;
      border: 1px solid var(--assist-ghost-border);
      border-radius: 50%;
      background: var(--assist-bg-strong);
      color: var(--assist-muted);
      font-size: 15px;
      font-weight: 500;
      cursor: pointer;
      opacity: 0.8;
      backdrop-filter: blur(24px) saturate(180%);
      -webkit-backdrop-filter: blur(24px) saturate(180%);
      transition: opacity 200ms ease, transform 200ms ease, color 200ms ease, background 200ms ease;
      box-shadow: 0 4px 12px var(--assist-shadow);
    }

    .help-ghost.active {
      opacity: 1;
      color: var(--assist-fg);
      background: var(--assist-card-bg);
    }

    .help-card {
      position: fixed;
      right: 24px;
      bottom: 76px;
      z-index: 21;
      width: min(92vw, 260px);
      padding: 16px;
      border-radius: var(--dock-radius);
      border: 1px solid var(--assist-card-border);
      background: var(--assist-card-bg);
      box-shadow: 0 20px 40px var(--assist-shadow);
      backdrop-filter: blur(32px) saturate(180%);
      -webkit-backdrop-filter: blur(32px) saturate(180%);
      color: var(--assist-fg);
      opacity: 0;
      transform: translateY(8px) scale(0.98);
      visibility: hidden;
      pointer-events: none;
      transition: opacity 240ms ease, transform 240ms cubic-bezier(0.22, 1, 0.36, 1), visibility 0s linear 240ms;
    }

    .help-card.open {
      opacity: 1;
      transform: translateY(0) scale(1);
      visibility: visible;
      pointer-events: auto;
      transition: opacity 240ms ease, transform 240ms cubic-bezier(0.22, 1, 0.36, 1), visibility 0s linear 0s;
    }

    .keys {
      display: grid;
      grid-template-columns: 1fr;
      gap: 4px;
    }

    .help-credit {
      margin-top: 16px;
      text-align: center;
      font-size: 12px;
      font-weight: 500;
      color: var(--assist-muted);
    }

    .help-credit a {
      color: inherit;
      text-decoration: none;
      transition: opacity 150ms ease, color 150ms ease;
    }

    .help-credit a:hover {
      opacity: 1;
      color: var(--ui-ink);
    }

    .shortcut {
      width: 100%;
      min-height: 36px;
      padding: 6px 8px 6px 10px;
      border-radius: 6px;
      border: none;
      background: transparent;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      box-sizing: border-box;
      cursor: pointer;
      color: var(--assist-fg);
      transition: background 150ms ease;
    }
    
    .shortcut:hover {
      background: var(--assist-key-bg);
    }

    .shortcut-label {
      color: var(--assist-muted);
      font-size: 13px;
      font-weight: 500;
      line-height: 1.2;
      text-align: left;
    }

    .shortcut-key {
      min-width: 26px;
      height: 24px;
      padding: 0 6px;
      border-radius: 4px;
      border: 1px solid var(--assist-key-border);
      background: var(--assist-key-bg);
      color: var(--assist-fg);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 600;
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }
    
    body.ui-light .shortcut-key {
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }

    .shortcut-action {
      appearance: none;
      font: inherit;
      text-align: left;
    }

    .shortcut-action.active {
      background: rgba(10, 102, 194, 0.1);
    }

    .shortcut-action.active .shortcut-key {
      border-color: var(--ui-ring);
      color: var(--ui-ring);
    }

    .hint-toast {
      position: fixed;
      left: 50%;
      bottom: calc(clamp(14px, 4vh, 38px) + 96px);
      transform: translateX(-50%) translateY(8px);
      z-index: 9;
      padding: 10px 24px;
      border-radius: 999px;
      border: 1px solid var(--ui-hairline);
      background: var(--ui-glass-a);
      color: var(--assist-fg);
      font-size: 14px;
      font-weight: 500;
      backdrop-filter: blur(24px) saturate(180%);
      -webkit-backdrop-filter: blur(24px) saturate(180%);
      opacity: 0;
      visibility: hidden;
      transition: opacity 900ms ease, transform 900ms ease, visibility 0s linear 900ms;
      pointer-events: none;
      box-shadow: 0 10px 30px var(--ui-shadow);
    }

    .hint-toast.visible {
      opacity: 1;
      visibility: visible;
      transform: translateX(-50%) translateY(0);
      transition: opacity 1800ms ease, transform 1800ms ease, visibility 0s linear 0s;
    }

    .visually-hidden {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      border: 0;
    }

    .noscript-banner {
      position: fixed;
      inset: auto 14px 14px;
      z-index: 30;
      max-width: min(560px, calc(100vw - 28px));
      padding: 12px 16px;
      border-radius: 8px;
      border: 1px solid var(--ui-hairline);
      background: var(--assist-bg-strong);
      color: var(--assist-fg);
      font-size: 14px;
      font-weight: 500;
    }

    @media (hover: hover) and (pointer: fine) {
      .swatch:hover {
        transform: translateY(-2px);
      }

      .help-ghost:hover {
        opacity: 1;
        background: var(--assist-card-bg);
      }

      .apply-btn:hover {
        filter: brightness(1.1);
      }
    }

    .swatch:active {
      transform: translateY(0);
    }

    .apply-btn:active {
      transform: translateY(1px);
    }

    @media (max-width: 540px) {
      .dock {
        gap: 8px;
        padding: 8px;
      }
      .swatch {
        width: 40px;
        height: 40px;
      }
      .custom-form input {
        font-size: 16px;
      }
      .help-card {
        right: 14px;
        bottom: 70px;
        width: min(94vw, 242px);
      }
      .help-ghost {
        right: 14px;
        bottom: 14px;
      }
    }
  </style>
</head>
<body>
  <main class="visually-hidden">
    <h1>Fill</h1>
    <p>Fill Your Screen with Solid Colors.</p>
  </main>
  <noscript>
    <div class="noscript-banner">JavaScript is required to use Fill. Enable JavaScript and reload this page.</div>
  </noscript>
  <div id="controls" aria-hidden="true">
    <div class="dock-wrap" role="dialog" aria-label="Color controls">
      <div class="dock" role="group" aria-label="Color choices">
        <button class="swatch swatch-black" type="button" data-color="black" aria-label="Black">
          <span class="visually-hidden">Black</span>
        </button>
        <button class="swatch swatch-white" type="button" data-color="white" aria-label="White">
          <span class="visually-hidden">White</span>
        </button>
        <button class="swatch swatch-red" type="button" data-color="red" aria-label="Red">
          <span class="visually-hidden">Red</span>
        </button>
        <button class="swatch swatch-custom" id="customToggle" type="button" aria-label="Custom color" aria-controls="customForm" aria-expanded="false">
          <span>+</span>
        </button>
      </div>
      <form id="customForm" class="custom-form" novalidate aria-hidden="true">
        <span id="colorDot" class="color-dot" aria-hidden="true"></span>
        <label class="visually-hidden" for="colorInput">Custom color</label>
        <input id="colorInput" type="text" autocomplete="off" spellcheck="false" placeholder="Any CSS color" aria-describedby="error">
        <button id="applyBtn" class="apply-btn" type="submit" aria-label="Apply color">></button>
      </form>
      <div id="error" role="status" aria-live="polite"></div>
    </div>
  </div>

  <button id="helpGhost" class="help-ghost" type="button" aria-label="Show shortcuts" aria-controls="helpCard" aria-expanded="false">?</button>

  <div id="helpCard" class="help-card" role="dialog" aria-hidden="true" aria-label="Shortcuts and options">
    <div class="keys">
      <button class="shortcut shortcut-action" type="button" data-shortcut-action="black">
        <span class="shortcut-label">Black</span><span class="shortcut-key">B</span>
      </button>
      <button class="shortcut shortcut-action" type="button" data-shortcut-action="white">
        <span class="shortcut-label">White</span><span class="shortcut-key">W</span>
      </button>
      <button class="shortcut shortcut-action" type="button" data-shortcut-action="red">
        <span class="shortcut-label">Red</span><span class="shortcut-key">R</span>
      </button>
      <button class="shortcut shortcut-action" type="button" data-shortcut-action="custom">
        <span class="shortcut-label">Custom</span><span class="shortcut-key">C</span>
      </button>
      <button class="shortcut shortcut-action" type="button" data-shortcut-action="fullscreen">
        <span class="shortcut-label">Fullscreen</span><span class="shortcut-key">F</span>
      </button>
      <button class="shortcut shortcut-action" type="button" data-shortcut-action="hide">
        <span class="shortcut-label">Hide</span><span class="shortcut-key">Esc</span>
      </button>
      <button id="pinToggle" class="shortcut shortcut-action" type="button" data-shortcut-action="pin" aria-pressed="false">
        <span id="pinLabel" class="shortcut-label">Pin controls</span>
        <span class="shortcut-key">P</span>
      </button>
    </div>
    <div class="help-credit">Created by <a href="https://x.com/tavlean" target="_blank" rel="noopener noreferrer">Tavlean</a></div>
  </div>

  <div id="hintToast" class="hint-toast" aria-live="polite">Click anywhere for controls</div>

  <script>
    (function () {
      var controls = document.getElementById("controls");
      var panel = controls.querySelector(".dock-wrap");
      var customForm = document.getElementById("customForm");
      var customToggle = document.getElementById("customToggle");
      var colorDot = document.getElementById("colorDot");
      var input = document.getElementById("colorInput");
      var errorEl = document.getElementById("error");
      var presetButtons = controls.querySelectorAll("[data-color]");
      var helpGhost = document.getElementById("helpGhost");
      var helpCard = document.getElementById("helpCard");
      var pinToggle = document.getElementById("pinToggle");
      var pinLabel = document.getElementById("pinLabel");
      var hintToast = document.getElementById("hintToast");
      var themeColorMeta = document.getElementById("themeColorMeta");
      var canonicalLink = document.querySelector("link[rel='canonical']");
      var ogUrlMeta = document.querySelector("meta[property='og:url']");
      var ogImageMeta = document.querySelector("meta[property='og:image']");
      var twitterImageMeta = document.querySelector("meta[name='twitter:image']");

      var PRESETS = ["black", "white", "red"];
      var currentColor = "black";
      var panelVisible = false;
      var customVisible = false;
      var helpVisible = false;
      var controlsPinned = false;
      var hideTimer = null;
      var errorTimer = null;
      var hintTimer = null;
      var hintDelayTimer = null;
      var hoverHintsEnabled = !!(window.matchMedia && window.matchMedia("(hover: hover) and (pointer: fine)").matches);
      var hintShownFromHover = false;
      var HOVER_HINT_DELAY_MS = 1500;
      var HIDE_DELAY_MS = 5000;

      function parseRgb(text) {
        var parts = text && text.match(/[\d.]+/g);
        if (!parts || parts.length < 3) {
          return null;
        }
        return {
          r: Math.max(0, Math.min(255, parseFloat(parts[0]))),
          g: Math.max(0, Math.min(255, parseFloat(parts[1]))),
          b: Math.max(0, Math.min(255, parseFloat(parts[2])))
        };
      }

      function updateUiTone() {
        var rgb = parseRgb(getComputedStyle(document.body).backgroundColor);
        if (!rgb) {
          return;
        }
        var luminance = (0.2126 * rgb.r + 0.7152 * rgb.g + 0.0722 * rgb.b) / 255;
        var lightBg = luminance > 0.62;
        document.body.classList.toggle("ui-light", lightBg);
      }

      function updateThemeColorMeta(color) {
        if (!themeColorMeta) {
          return;
        }
        themeColorMeta.setAttribute("content", color);
      }

      function updateUrlMetadata() {
        var isHttp = window.location.protocol === "http:" || window.location.protocol === "https:";
        var canonical = isHttp ? window.location.origin + window.location.pathname : (window.location.pathname || "/");
        if (canonicalLink) {
          canonicalLink.setAttribute("href", canonical);
        }
        if (ogUrlMeta) {
          ogUrlMeta.setAttribute("content", canonical);
        }
        if (isHttp && ogImageMeta) {
          ogImageMeta.setAttribute("content", window.location.origin + "/assets/images/social-preview.png");
        }
        if (isHttp && twitterImageMeta) {
          twitterImageMeta.setAttribute("content", window.location.origin + "/assets/images/social-preview.png");
        }
      }

      function setActiveSwatch(source) {
        presetButtons.forEach(function (button) {
          var isActive = button.getAttribute("data-color") === source;
          button.classList.toggle("is-active", isActive);
          button.setAttribute("aria-pressed", isActive ? "true" : "false");
        });
        var customActive = source === "custom";
        customToggle.classList.toggle("is-active", customActive);
        customToggle.setAttribute("aria-pressed", customActive ? "true" : "false");
      }

      function setColor(color, source) {
        currentColor = color;
        document.body.style.backgroundColor = color;
        colorDot.style.background = color;
        updateThemeColorMeta(color);
        updateUiTone();

        if (source === "custom") {
          customToggle.style.setProperty("--custom-preview", color);
          setActiveSwatch("custom");
          return;
        }

        if (PRESETS.indexOf(source) !== -1) {
          setActiveSwatch(source);
          return;
        }

        setActiveSwatch("custom");
      }

      function clearError() {
        clearTimeout(errorTimer);
        errorEl.classList.remove("visible");
        errorEl.textContent = "";
      }

      function hideHint() {
        clearTimeout(hintDelayTimer);
        hintDelayTimer = null;
        clearTimeout(hintTimer);
        hintToast.classList.remove("visible");
      }

      function showHint() {
        if (!hoverHintsEnabled) {
          return;
        }
        hintToast.classList.add("visible");
        hintTimer = setTimeout(hideHint, 4800);
      }

      function shouldPauseAutoHide() {
        var active = document.activeElement;
        var hasControlFocus = active && controls.contains(active);
        var helpFocused = active && helpCard.contains(active);
        return controlsPinned ||
          panel.matches(":hover") ||
          hasControlFocus ||
          (helpVisible && (helpCard.matches(":hover") || helpFocused));
      }

      function resetHideTimer() {
        clearTimeout(hideTimer);
        if (!panelVisible || controlsPinned) {
          return;
        }
        hideTimer = setTimeout(function () {
          if (shouldPauseAutoHide()) {
            resetHideTimer();
            return;
          }
          hidePanel();
        }, HIDE_DELAY_MS);
      }

      function setCustomVisible(visible, focusInput) {
        customVisible = visible;
        customForm.classList.toggle("open", visible);
        customForm.setAttribute("aria-hidden", String(!visible));
        customToggle.setAttribute("aria-expanded", visible ? "true" : "false");
        if (!visible) {
          input.blur();
          clearError();
          return;
        }
        if (focusInput) {
          input.focus();
          input.select();
        }
      }

      function setHelpVisible(visible) {
        helpVisible = visible;
        helpCard.classList.toggle("open", visible);
        helpCard.setAttribute("aria-hidden", String(!visible));
        helpGhost.classList.toggle("active", visible);
        helpGhost.setAttribute("aria-expanded", visible ? "true" : "false");
        helpGhost.setAttribute("aria-label", visible ? "Hide shortcuts" : "Show shortcuts");
      }

      function updatePinUi() {
        pinToggle.classList.toggle("active", controlsPinned);
        pinToggle.setAttribute("aria-pressed", controlsPinned ? "true" : "false");
        pinLabel.textContent = controlsPinned ? "Pinned controls" : "Pin controls";
      }

      function showPanel(focusInput) {
        hideHint();
        if (!panelVisible) {
          panelVisible = true;
          controls.classList.add("visible");
          controls.setAttribute("aria-hidden", "false");
        }
        if (focusInput) {
          setCustomVisible(true, true);
        }
        resetHideTimer();
      }

      function hidePanel() {
        clearTimeout(hideTimer);
        panelVisible = false;
        if (controlsPinned) {
          controlsPinned = false;
          updatePinUi();
        }
        controls.classList.remove("visible");
        controls.setAttribute("aria-hidden", "true");
        setCustomVisible(false, false);
      }

      function finalizeColorSelection() {
        if (controlsPinned) {
          setCustomVisible(false, false);
          resetHideTimer();
          return;
        }
        hidePanel();
      }

      function showError(message) {
        clearTimeout(errorTimer);
        errorEl.textContent = message;
        errorEl.classList.add("visible");
        errorTimer = setTimeout(function () {
          errorEl.classList.remove("visible");
          errorEl.textContent = "";
        }, 1300);
      }

      function tryApplyCustomColor() {
        var value = input.value.trim();
        if (!value) {
          showError("Invalid color");
          setCustomVisible(true, true);
          resetHideTimer();
          return;
        }

        if (window.CSS && CSS.supports && CSS.supports("color", value)) {
          setColor(value, "custom");
          finalizeColorSelection();
          return;
        }

        showError("Invalid color");
        setCustomVisible(true, true);
        resetHideTimer();
      }

      function toggleFullscreen() {
        try {
          if (!document.fullscreenElement && document.documentElement.requestFullscreen) {
            document.documentElement.requestFullscreen();
          } else if (document.fullscreenElement && document.exitFullscreen) {
            document.exitFullscreen();
          }
        } catch (_err) {
        }
      }

      function applyPresetShortcut(color) {
        setColor(color, color);
        if (panelVisible) {
          finalizeColorSelection();
        }
      }

      function togglePinShortcut() {
        controlsPinned = !controlsPinned;
        updatePinUi();
        if (controlsPinned) {
          showPanel(false);
        } else {
          resetHideTimer();
        }
      }

      function hideShortcut(closeHelpFirst) {
        if (closeHelpFirst && helpVisible) {
          setHelpVisible(false);
          return;
        }
        hidePanel();
      }

      function runShortcutAction(action) {
        if (action === "black" || action === "white" || action === "red") {
          applyPresetShortcut(action);
          return;
        }
        if (action === "custom") {
          showPanel(true);
          return;
        }
        if (action === "fullscreen") {
          toggleFullscreen();
          return;
        }
        if (action === "hide") {
          hideShortcut(true);
          return;
        }
        if (action === "pin") {
          togglePinShortcut();
        }
      }

      presetButtons.forEach(function (button) {
        button.addEventListener("click", function (event) {
          event.stopPropagation();
          setColor(button.getAttribute("data-color"), button.getAttribute("data-color"));
          finalizeColorSelection();
        });
      });

      customToggle.addEventListener("click", function (event) {
        event.stopPropagation();
        showPanel(false);
        setCustomVisible(!customVisible, !customVisible);
        resetHideTimer();
      });

      customForm.addEventListener("submit", function (event) {
        event.preventDefault();
        tryApplyCustomColor();
      });

      input.addEventListener("keydown", function (event) {
        if (event.key === "Escape") {
          event.preventDefault();
          hidePanel();
          return;
        }
        resetHideTimer();
      });

      input.addEventListener("input", function () {
        clearError();
        resetHideTimer();
      });

      controls.addEventListener("focusin", function () {
        resetHideTimer();
      });

      panel.addEventListener("pointerdown", function (event) {
        event.stopPropagation();
        resetHideTimer();
      });

      panel.addEventListener("pointermove", function () {
        resetHideTimer();
      });

      panel.addEventListener("pointerleave", function () {
        resetHideTimer();
      });

      helpGhost.addEventListener("pointerdown", function (event) {
        event.stopPropagation();
      });

      helpCard.addEventListener("pointerdown", function (event) {
        event.stopPropagation();
      });

      helpGhost.addEventListener("click", function () {
        hideHint();
        setHelpVisible(!helpVisible);
      });

      helpCard.addEventListener("click", function (event) {
        var actionButton = event.target.closest("[data-shortcut-action]");
        if (!actionButton || !helpCard.contains(actionButton)) {
          return;
        }
        var action = actionButton.getAttribute("data-shortcut-action");
        if (action === "hide") {
          hideShortcut(false);
          return;
        }
        runShortcutAction(action);
      });

      document.addEventListener("pointerdown", function (event) {
        hideHint();
        if (helpVisible && !helpCard.contains(event.target) && event.target !== helpGhost) {
          setHelpVisible(false);
          return;
        }
        if (helpCard.contains(event.target) || event.target === helpGhost) {
          return;
        }
        if (panel.contains(event.target)) {
          return;
        }
        showPanel(false);
      });

      document.addEventListener("pointermove", function (event) {
        if (!hoverHintsEnabled || hintShownFromHover || panelVisible || helpVisible || hintDelayTimer) {
          return;
        }
        if (event.pointerType && event.pointerType !== "mouse") {
          return;
        }
        hintDelayTimer = setTimeout(function () {
          hintDelayTimer = null;
          if (panelVisible || helpVisible || hintShownFromHover) {
            return;
          }
          hintShownFromHover = true;
          showHint();
        }, HOVER_HINT_DELAY_MS);
      });

      document.addEventListener("keydown", function (event) {
        var key = event.key;
        var active = document.activeElement;
        var typingInCustom = !!(active && customForm.contains(active));
        hideHint();

        if (key === "Escape") {
          runShortcutAction("hide");
          return;
        }

        if (typingInCustom) {
          return;
        }

        if (key === "?" || (key === "/" && event.shiftKey)) {
          event.preventDefault();
          setHelpVisible(!helpVisible);
          return;
        }

        if (key === "b" || key === "B") {
          runShortcutAction("black");
          return;
        }
        if (key === "w" || key === "W") {
          runShortcutAction("white");
          return;
        }
        if (key === "r" || key === "R") {
          runShortcutAction("red");
          return;
        }
        if (key === "c" || key === "C") {
          event.preventDefault();
          runShortcutAction("custom");
          return;
        }
        if (key === "f" || key === "F") {
          event.preventDefault();
          runShortcutAction("fullscreen");
          return;
        }
        if (key === "p" || key === "P") {
          event.preventDefault();
          runShortcutAction("pin");
          return;
        }
        if (
          key === "Enter" ||
          key === "NumpadEnter" ||
          key === "OK" ||
          key === "Select"
        ) {
          if (document.activeElement === input) {
            return;
          }
          event.preventDefault();
          showPanel(true);
        }
      });

      updatePinUi();
      updateUrlMetadata();
      setColor(currentColor, "black");
      setCustomVisible(false, false);
      setHelpVisible(false);
    })();
  </script>
</body>
</html>
